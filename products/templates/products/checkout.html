{% extends "base.html" %}
{% load crispy_forms_tags %} 
{% load static %}
{% load for_loop_extras %}
{% load checked_time %}
{% block content %}

<head>
<style type="text/css">

.change-ava{
  min-width:155px;
}

#trigger {
    visibility: hidden; 
    display: none; 
  } 



.col-form-label  {
  position: absolute;
  opacity: 0.5;
  color: gray;
  padding-left: calc(.375rem + 1px);
  padding-top: calc(.390rem + 2px);
  font-size: 14px;
}

.labels-placement input[type=text], input[type=email], select{
  padding-bottom: 3px !important;
  padding-top: 13px !important;
  padding-left: calc(.375rem + 1px) !important;
  font-size: 14px !important;
}

@media only screen and (max-width: 768px) {
  .col-form-label  {
    font-size: 13px;
  }
  .settings-btn, .checkout-btn {
    width: 100% !important;
  }
  .settings-container, .checkout-container {
    width: 100% !important;
  }
}

.credit label{
  display:flex; 
  font-size:10px; 
  color:white; 
  opacity:.4; 
  margin-bottom: 0px; 
  padding-top: 5px;
}

.credit input{
  background:transparent;
  border:none;
  border-bottom:1px solid transparent;
  color:#dbdce0; transition: 
  border-bottom .4s; 
  width:100% !important;
}

.credit input:focus{
  border-bottom:1px solid #1abc9c; 
  outline:none;
}

.credit{
  background:#16181a; 
  border-radius:14px !important; 
  max-width: 340px; 
  margin: 10px auto 40px auto;
  padding:40px 30px 10px 30px; 
  box-shadow: 2px 10px 40px black; 
  line-height: normal;
}

.logo-card{
  max-width:50px; 
  margin-top: -50px;
}


</style>
</head>




<form action="" method="POST" role="form" enctype='multipart/form-data' class=''>
{% csrf_token %}
<div class='container checkout-container' style="width:70%">
  <div class="row">





<p class="col-12 text-center heading ">Айтем</p>
  <div class='col-xs-12 col-sm-6 text-center col-md-6 col-lg-3  p-0 mx-auto'>
    {% include 'products/snippets/card-checkout.html' with instance=product %}
  </div>




{% if request.user.region.region_code == 'ua' %}

<p class="col-12 text-center heading" style="border-top: 1px solid gray; padding-top: 1rem;">Доставка</p>

<div class="col-12 labels-placement" style="padding-bottom: 1rem;">
  <div class="row">

    <div class="col-xs-12 col-md-6  ">
      <div class="row">
        <div class="col-12">
          {{form.address_form.city|as_crispy_field}}
        </div>  
      </div>
    </div>

    <div class="col-xs-12 col-md-6  ">
      <div class="row">
        <div class="col-12">
          {{form.address_form.post_office|as_crispy_field}}
        </div>  
      </div>
    </div>

    <div class="col-xs-12 col-md-6  ">
      <div class="row">
        <div class="col-12">
          {{form.address_form.name|as_crispy_field}}
        </div>   
      </div>
    </div>

    <div class="col-xs-12 col-md-6  ">
      <div class="row">
        <div class="col-12">
          {{form.address_form.phone|as_crispy_field}}
        </div>   
      </div>
    </div>

  </div>
</div>


{% else %}

  <p class="col-12 text-center heading" style="border-top: 1px solid gray; padding-top: 1rem;">Адрес</p>

  <div class="col-12 labels-placement" style="padding-bottom: 1rem;">
    <div class="row">

      <div class="col-xs-12 col-md-6">
        <div class="row">

          <div class="col-12">
            {{form.address_form.name|as_crispy_field}}
          </div>        
        
          <div class="col-8">
            {{form.address_form.street|as_crispy_field}} 
          </div>       
       
          <div class="col-4">
            {{form.address_form.number|as_crispy_field}}
          </div>

        </div>
      </div>

      <div class="col-xs-12 col-md-6">
        <div class="row">

          <div class="col-12">
            {{form.address_form.additional_line|as_crispy_field}}
          </div>        
        
          <div class="col-8">
            {{form.address_form.city|as_crispy_field}} 
          </div>       
       
          <div class="col-4">
            {{form.address_form.postal_code|as_crispy_field}}
          </div>

        </div>
      </div>

      <div class="col-xs-12 col-md-6">
        <div class="row">

          <div class="col-12">
            {{form.address_form.country|as_crispy_field}}
          </div>  

        </div>
      </div>  


        
      <div class="col-xs-12 col-md-6">
        <div class="row">

          <div class="col-12">
            {{form.address_form.state|as_crispy_field}}
          </div>  
          
        </div>
      </div> 

      <div class="col-xs-12 col-md-6">
        <div class="row">

          <div class="col-12">
            {{form.address_form.post_office|as_crispy_field}}
          </div>  
          
        </div>
      </div> 

    </div>
  </div>

{% endif %}


<p class="col-12 text-center heading" style="border-top: 1px solid gray; padding-top: 1rem;">Платежные данные</p>

<div class="col-xs-12 col-md-6">
  <div class="credit">
    <img src="https://seeklogo.com/images/V/VISA-logo-62D5B26FE1-seeklogo.com.png" class="logo-card">
    <img src="https://seeklogo.net/wp-content/uploads/2011/08/mastercard-logo.png" class="logo-card">
     <div class="row">

      <div class="col-12 p-0 m-0">
        <label>Name:</label>
        <div class=''>
        {{form.card_form.holder}}
        </div>
      </div>

      <div class="col-12 p-0 m-0">
          <label>Card number:</label>
        <div class="">
        {{form.card_form.number}}
        </div>
      </div>

      <div class="col-4  p-0 m-0">
        <label>Month:</label>
        <div class="">
        {{form.card_form.month}}
        </div>
      </div>

      <div class="col-4 p-0 m-0">
        <label>Year:</label>
        <div class=''>
        {{form.card_form.year}}
        </div>
      </div>

      <div class="col-4 p-0 m-0">
        <label>CVV:</label>
        <div class=''>
        {{form.card_form.cvv}}
        </div>
      </div>

    </div>
  </div>
</div>


<div class="col-xs-12 col-md-6 pt-3 " style="padding-bottom: 1rem;">
  <div class='row'>
    <div class="col-6 text-left">
      Стоимость айтема:
    </div>
    <div class="col-6 text-right">
      {{ product.price|to_user_currency:request }}
    </div>
    <div class="col-6 text-left">
      Стоимость доставки:
    </div>
    {% if product.shipping_price.national_shipping %}
      <div class="col-6 text-right">
        {{ product.shipping_price.national_shipping|to_user_currency:request }}
      </div>
    {% endif %}
    <div class="col-6 text-left">
      К оплате:
    </div>
    <div class="col-6 text-right">
      {{ product.make_total|to_user_currency:request }}
    </div>
</div>

    <div class="col-12 text-center" style='border-top: 1px solid gray; padding-top: 1rem'>
        <button type="submit" class="mt-3 btn button-black hover-button large-button btn-block checkout-btn" style='width:25%;'>{{ buy_btn }}</button>
    </div>

  </div>
</div>
</form>






<script>
  var currentPath = window.location.href
  if (currentPath.indexOf("details") != -1){

      var languageOption = $('#language').val()
      var avatar = $('.avatar-upload-button')
      console.log(languageOption)
      avatar.hide()
      avatar.parent().prepend('<label for="avatar_custom" class="bt  hover-button button-white medium-button m-0">' + avatar.attr('label_for_btn') + '</label>')
      $(".avatar-upload-button").change(function (){
          var fieldVal = event.target.files[0].name;
          if (fieldVal != undefined || fieldVal != ""){
            if ($(".filepath")[0]) {
              $(".filepath").text(fieldVal);
            }
            else{
              avatar.parent().append("<small><span class='filepath'>" + fieldVal + "</span></small>")
            }
          }
        });
  };

</script>

{% endblock %}



